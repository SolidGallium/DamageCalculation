<!DOCTYPE html>
<html lang = "en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
    <link rel = "stylesheet" type = "text/css" href = "style.css">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js" integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI" crossorigin="anonymous"></script>
    <script src="scripts/Main.js"></script>
    <script src="scripts/classes.js"></script>
    <script src="scripts/bosses.js"></script>
    <script src = "scripts/tanks.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/p5@1.0.0/lib/p5.js"></script>
  </head>

<!-- --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -->

  <body>

    <div class = "container-fluid m-0 w-100 text-center" id = "container">
<!-- --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -->
      <div class = "row mt-2">
<!-- --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -->
        <div id = "class" class = "col-2 ml-2 mr-1 rounded h-100">
          <div class = "row">
            <div class = "col mt-1">
              <h3>Class</h3>
            </div>
          </div>
          <div class = "row text-center">
            <div class = "col mb-1 mt-1">
              <button type = "button" class = "btn btn-primary btn-responsive dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" id = "classButton">Class</button>
              <div class = "dropdown-menu" aria-labelledby = "classButton">
                <a class = "dropdown-item classSelection" href = "#">Archer</a>
                <a class = "dropdown-item classSelection" href = "#">Berserker</a>
                <a class = "dropdown-item classSelection" href = "#">Brawler</a>
                <a class = "dropdown-item classSelection" href = "#">Gunner</a>
                <a class = "dropdown-item classSelection" href = "#">Lancer</a>
                <a class = "dropdown-item classSelection" href = "#">Mystic</a>
                <a class = "dropdown-item classSelection" href = "#">Ninja</a>
                <a class = "dropdown-item classSelection" href = "#">Priest</a>
                <a class = "dropdown-item classSelection" href = "#">Reaper</a>
                <a class = "dropdown-item classSelection" href = "#">Slayer</a>
                <a class = "dropdown-item classSelection" href = "#">Sorcerer</a>
                <a class = "dropdown-item classSelection" href = "#">Valkyrie</a>
                <a class = "dropdown-item classSelection" href = "#">Warrior</a>
              </div>
            </div>
          </div>
          <div class = "row mt-2 align-items-center">
            <div class = "col text-center">
              <h5>Base Crit: 
                <span class = "text-white" id = "baseCrit">0</span>
              </h5>
            </div>
          </div>
          <div class = "row mt-2 mb-3">
            <div class = "col">
              <div class="input-group ">
                <div class="input-group-prepend">
                  <span class="input-group-text text-white bg-primary border-0 responsiveText" id="inputGroup-sizing-default">Crit:</span>
                </div>
                <input type="text" class="form-control bg-dark border-0 text-light text-center responsiveText" aria-label="Default" aria-describedby="inputGroup-sizing-default" id = "critInput">
                <div class = "input-group-append">
                  <button type = "button" class = "btn btn-primary dropdown-toggle responsiveText" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" id = "critButton">Total Crit</button>
                  <div class = "dropdown-menu" aria-labelledby = "critButton">
                    <a class = "dropdown-item critSelection" href = "#">Total Crit</a>
                    <a class = "dropdown-item critSelection" href = "#">Bonus Crit</a>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
<!-- --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -->
        <div id = "buffs" class = "col-4 ml-1 mr-1 rounded h-100">
          <div class = "row">
            <div class = "col mt-1">
              <h3>Buffs</h3>
            </div>
          </div>
          <div class = "row mt-1 mb-3 align-items-end">
            <div class = "col-4">
              <button type = "button" class = "btn btn-primary btn-responsive dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" id = "healerButton">Healer</button>
                <div class = "dropdown-menu" aria-labelledby = "healerButton">
                  <a class = "dropdown-item healerSelection" href = "#">Mystic</a>
                  <a class = "dropdown-item healerSelection" href = "#">Priest</a>
                  <a class = "dropdown-item healerSelection" href = "#">Mystic + Priest</a>  
                  <a class = "dropdown-item healerSelection" href = "#">None</a>  
                </div>
            </div>
            <div class = "col text-right">
              <h5>Buffed Crit: 
                <span class = "text-white" id = "buffedCrit">0</span>
              </h5>
            </div>
          </div>
        </div>
<!-- --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -->
        <div id = "bosses" class = "col-2 ml-1 mr-1 rounded h-100">
          <div class = "row">
            <div class = "col mt-1">
              <h3>Boss</h3>
            </div>
          </div>
          <div class = "row mb-3">
            <div class = "col">
              <button type = "button" class = "btn btn-primary btn-responsive dropdown-toggle" data-toggle = "dropdown" aria-hashpopup = "true" aria-expanded="false" id = "bossButton">Boss</button>
              <div class = "dropdown-menu" aria-labelledby = "bossButton">
                <a class = "dropdown-item bossSelection" href = "#">Nightmare Kalligar (DAHM)</a>
                <a class = "dropdown-item bossSelection" href = "#">Kalligar (DANM)</a>
                <a class = "dropdown-item bossSelection" href = "#">Immortal Kelsaik (CSHM)</a>
                <a class = "dropdown-item bossSelection" href = "#">Kelsaik (CSNM)</a>
                <a class = "dropdown-item bossSelection" href = "#">Hagufna (FA)</a>
                <a class = "dropdown-item bossSelection" href = "#">Ironfang Dixie (SOH)</a>
                <a class = "dropdown-item bossSelection" href = "#">Bahaar</a>
                <a class = "dropdown-item bossSelection" href = "#">Akalath Travan (AQ)</a>
                <a class = "dropdown-item bossSelection" href = "#">Akalath Kashir (AQ)</a>
                <a class = "dropdown-item bossSelection" href = "#">Hellgramite (GVH)</a>
                <a class = "dropdown-item bossSelection" href = "#">Gossamer Reagent (GVH)</a>
                <a class = "dropdown-item bossSelection" href = "#">Nightmare Nedra (GLSH)</a>
                <a class = "dropdown-item bossSelection" href = "#">Nightmare Ptakum (GLSH)</a>
                <a class = "dropdown-item bossSelection" href = "#">Nightmare Kylos (GLSH)</a>
                <a class = "dropdown-item bossSelection" href = "#">Nightmare Ghergof (AAH)</a>
                <a class = "dropdown-item bossSelection" href = "#">Nightmare Kalioth (AAH)</a>
                <a class = "dropdown-item bossSelection" href = "#">Nightmare Antaroth (AAH)</a>
                <a class = "dropdown-item bossSelection" href = "#">Kalavese (RR)</a>
                <a class = "dropdown-item bossSelection" href = "#">Thormentum (RR)</a>
                <a class = "dropdown-item bossSelection" href = "#">Argog (RR)</a>
                <a class = "dropdown-item bossSelection" href = "#">Ventarun (RK9)</a>
                <a class = "dropdown-item bossSelection" href = "#">Hexapleon (RK9)</a>
                <a class = "dropdown-item bossSelection" href = "#">RK-9 (RK9)</a>
              </div>
            </div>
          </div>
          <div class = "row align-items-center mb-2">
            <div class = "col">
              <h5 class = "text-light m-0">Level</h5>
            </div>
            <div class = "col">
              <div class = "input-group">
                <input type = "text" value = "0" class = "form-control bg-dark border-0 text-light text-center responsiveText" aria-label = "Default" aria-describedby = "inputGroup-sizing-default" id = "bossLevel">
              </div>
            </div>
          </div>
          <div class = "row align-items-center mb-2">
            <div class = "col">
              <h5 class = "text-light m-0">Crit Resist</h5>
            </div>
            <div class = "col">
              <div class = "input-group">
                <input type = "text" value = "0" class = "form-control bg-dark border-0 text-light text-center responsiveText" aria-label = "Default" aria-describedby = "inputGroup-sizing-default" id = "critResist">
              </div>
            </div>
          </div>
          <div class = "row align-items-center mb-3">
            <div class = "col">
              <h5 class = "text-light m-0">Amp Resist</h5>
            </div>
            <div class = "col">
              <div class = "input-group">
                <input type = "text" value = "0" class = "form-control bg-dark border-0 text-light text-center responsiveText" aria-label = "Default" aria-describedby = "inputGroup-sizing-default" id = "ampResist">
              </div>
            </div>
          </div>
        </div>
<!-- --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -->
        <div id = "debuffs" class = "col ml-1 mr-2 rounded h-100">
          <div class = "row mt-1">
            <div class = "col">
              <h3>Debuffs</h3>
            </div>
          </div>

          <div class = "row mb-3 mt-1">
            <div class = "col">
              <button type = "button" class = "btn btn-primary btn-responsive dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" id = "tankButton">Tank</button>
              <div class = "dropdown-menu" aria-labelledby = "tankButton">
                <a class = "dropdown-item tankSelection" href = "#">Lancer</a>
                <a class = "dropdown-item tankSelection" href = "#">Warrior</a>
                <a class = "dropdown-item tankSelection" href = "#">Brawler</a>  
                <a class = "dropdown-item tankSelection" href = "#">Berserker</a>  
              </div>
            </div>
          </div>

          <div class = 'row pt-2 pb-2 align-items-center' style = "background: rgb(26, 26, 26)">
            <div class = 'col-2'>
              <img src = 'https://i.imgur.com/9czn5Km.png' class = 'img-fluid rounded' alt = 'missing image'>
            </div> 
            <div class = 'col-4'>
              <h5 class = 'text-light m-0'>Physical Shred</h5>
            </div>
            
            <div class = 'col-2'>
              <div class = 'input-group'> 
                <input type = 'text' value = '14000' class = 'form-control bg-dark border-0 text-light text-center responsiveText' aria-label = 'Default' aria-describedby = 'inputGroup-sizing-default'>
              </div>
            </div>

            <div class = 'col-4'>
              <div class = 'input-group'> 
                <div class = 'input-group-prepend'> 
                  <span class = 'input-group-text text-white bg-primary border-0 responsiveText'>Uptime: </span>
                </div>
                <input type = 'text' value = '100' class = 'form-control bg-dark border-0 text-light text-center responsiveText' aria-label = 'Default' aria-describedby = 'inputGroup-sizing-default'>
                  <span class = 'input-group-text text-white bg-primary border-0 responsiveTextHide'>
                    %
                  </span>
              </div>
            </div>
          </div>
          

          <div class = 'row pt-2 pb-2 align-items-center' style = "background: rgb(40, 40, 40)">
            <div class = 'col-2'>
              <img src = 'https://i.imgur.com/t08SApc.png' class = 'img-fluid rounded' alt = 'missing image'>
            </div> 
            <div class = 'col-4'>
              <h5 class = 'text-light m-0'>Magical Shred</h5>
            </div>
            
            <div class = 'col-2'>
              <div class = 'input-group'> 
                <input type = 'text' value = '14000' class = 'form-control bg-dark border-0 text-light text-center responsiveText' aria-label = 'Default' aria-describedby = 'inputGroup-sizing-default'>
              </div>
            </div>

            <div class = 'col-4'>
              <div class = 'input-group'> 
                <div class = 'input-group-prepend'> 
                  <span class = 'input-group-text text-white bg-primary border-0 responsiveText'>Uptime: </span>
                </div>
                <input type = 'text' value = '100' class = 'form-control bg-dark border-0 text-light text-center responsiveText' aria-label = 'Default' aria-describedby = 'inputGroup-sizing-default'>
                  <span class = 'input-group-text text-white bg-primary border-0 responsiveTextHide'>
                    %
                  </span>
              </div>
            </div>
          </div>

          <div class = 'row pt-2 pb-2 align-items-center' style = "background: rgb(26, 26, 26)">
            <div class = 'col-2'>
              <img src = 'https://i.imgur.com/eBSNI6N.png' class = 'img-fluid rounded' alt = 'missing image'>
            </div> 
            <div class = 'col'>
              <h5 class = 'text-light m-0'>Kaia's Judgement</h5>
            </div>

            <div class = 'col-5'>
              <div class = 'input-group'> 
                <div class = 'input-group-prepend'> 
                  <span class = 'input-group-text text-white bg-primary border-0 responsiveText'>Uptime: </span>
                </div>
                <input type = 'text' value = '80' class = 'form-control bg-dark border-0 text-light text-center responsiveText' aria-label = 'Default' aria-describedby = 'inputGroup-sizing-default'>
                  <span class = 'input-group-text text-white bg-primary border-0 responsiveTextHide'>
                    %
                  </span>
              </div>
            </div>
          </div>
        </div>
      </div>
    
<!-- --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -->
      <div class = "row mt-3">
        <div id = "skills" class = "col ml-2 mr-2 rounded h-100">
          <h3 class = "mt-1">SKILLS</h3>
        </div>
      </div>
    </div>

<!-- --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- -->

    <script>
      $('.classSelection').on('click', function() {
        $('#classButton').text($(this).text());
        changeClass($(this).text());

        renderBuffs();

        updateCrit();

        $('#baseCrit').text(classes[currentClass].baseCrit);
      });

      $('.bossSelection').on('click', function() {
        $('#bossButton').text($(this).text());
        changeBoss($(this).text());
        updateBossStats();
      });

      $('.critSelection').on('click', function() {
        $('#critButton').text($(this).text());
        if ($(this).text() == "Total Crit") {
          totalCrit = true;
        } else {
          totalCrit = false;
        }
        updateCrit();
      });

      $('.healerSelection').on('click', function() {
        $('#healerButton').text($(this).text());
        if ($(this).text() == "Priest") {
          priest = true;
          mystic = false;
        } else if ($(this).text() == "Mystic + Priest") {
          priest = true;
          mystic = true;
        } else if ($(this).text() == "Mystic") {
          mystic = true;
          priest = false;
        } else {
          mystic = false;
          priest = false;
        }
        renderBuffs();
        updateCrit();
      });

      $('.tankSelection').on('click', function() {
        $('#tankButton').text($(this).text());
        changeTank($(this).text());
        renderDebuffs();
      });

      function renderBuffs() {
        $('.createdBuffs').remove();

        var r;
        var g;
        var b;

        var last;

        if (priest == true) {
          $('#buffs').append(
            "<div class = 'row pt-2 pb-2 align-items-center createdBuffs' style = 'background: rgb(" + r + "," + g + "," + b +")'>" +
              "<div class = 'col-2'>" +
                "<img src = 'https://teralore.com/items/icon_skills/judgment_tex.png' class = 'img-fluid rounded' alt = 'missing image'>" +
              "</div>" +
              "<div class = 'col'>" + 
                "<h5 class = 'text-light m-0'>Edict of Judgement</h5>" +
              "</div>" +
              "<div class = 'col-5'>" +
                "<div class = 'input-group'>" +
                  "<div class = 'input-group-prepend'>" +
                    "<span class = 'input-group-text text-white bg-primary border-0 responsiveText'>Uptime: </span>" +
                  "</div>" +
                  "<input type = 'text' value = '33' class = 'form-control bg-dark border-0 text-light text-center responsiveText' aria-label = 'Default' aria-describedby = 'inputGroup-sizing-default'>" +
                  "<div class = 'input-group-append'>" + 
                    "<span class = 'input-group-text text-white bg-primary border-0 responsiveTextHide'>" +
                      "%" +
                    "</span>" +
                  "</div>" +
                "</div>" +
              "</div>" +
            "</div>");
        }

        for (var i = 0; i < classes[currentClass].buffs.length; i++) {
          if (i % 2 == 0) {
            r = 40;
            b = 40;
            g = 40;
          } else {
            r = 26;
            b = 26;
            g = 26;
          }

          if (i == classes[currentClass].buffs.length - 1) {
            last = "rounded-bottom";
          } else {
            last = "";
          }

          console.log(classes[currentClass].buffs[i].name);
          $('#buffs').append(
            "<div class = 'row pt-2 pb-2 align-items-center createdBuffs " + last + "' style = 'background: rgb(" + r + "," + g + "," + b +")'>" +
              "<div class = 'col-2'>" +
                "<img src = '" + classes[currentClass].buffs[i].skillImage + "' class = 'img-fluid rounded' alt = 'missing image'>" +
              "</div>" +
              "<div class = 'col'>" + 
                "<h5 class = 'text-light m-0'>" + classes[currentClass].buffs[i].name + "</h5>" +
              "</div>" +
              "<div class = 'col-5'>" +
                "<div class = 'input-group'>" +
                  "<div class = 'input-group-prepend'>" +
                    "<span class = 'input-group-text text-white bg-primary border-0 responsiveText'>Uptime: </span>" +
                  "</div>" +
                  "<input type = 'text' value = " + classes[currentClass].buffs[i].uptime * 100 + " class = 'form-control bg-dark border-0 text-light text-center responsiveText' aria-label = 'Default' aria-describedby = 'inputGroup-sizing-default'>" +
                  "<div class = 'input-group-append'>" + 
                    "<span class = 'input-group-text text-white bg-primary border-0 responsiveTextHide'>" +
                      "%" +
                    "</span>" +
                  "</div>" +
                "</div>" +
              "</div>" +
            "</div>");
      }
    }
    
      function renderDebuffs() {
        $(".createdDebuffs").remove();

        var r;
        var g;
        var b;

        var last;

        for (var i = 0; i < tanks[currentTank].debuffSkills.length; i++) {

          if (i % 2 == 0) {
            r = 40;
            b = 40;
            g = 40;
          } else {
            r = 26;
            b = 26;
            g = 26;
          }

          if (i == tanks[currentTank].debuffSkills.length - 1) {
            last = "rounded-bottom";
          } else {
            last = "";
          }

          $("#debuffs").append(
            "<div class = 'row  pt-2 pb-2 align-items-center createdDebuffs " + last + "' style = 'background: rgb(" + r + "," + g + "," + b +")'>" +
              "<div class = 'col-2'>" + 
                "<img src = " + tanks[currentTank].debuffSkills[i].image + " class = 'img-fluid rounded' alt = 'missing image'>" + 
              "</div>" + 
              "<div class = 'col'>" + 
                "<h5 class = 'text-light m-0'>" + tanks[currentTank].debuffSkills[i].name + "</h5>" +
              "</div>" +
              "<div class = 'col-5'>" + 
                "<div class = 'input-group'>" + 
                  "<div class = 'input-group-prepend'>" + 
                    "<span class = 'input-group-text text-white bg-primary border-0 responsiveText'>Uptime: </span>" +
                  "</div>" + 
                  "<input type = 'text' value = " + (tanks[currentTank].debuffSkills[i].uptime * 100) + " class = 'form-control bg-dark border-0 text-light text-center responsiveText' aria-label = 'Default' aria-describedby = 'inputGroup-sizing-default'>" +
                    "<span class = 'input-group-text text-white bg-primary border-0 responsiveTextHide'>" +
                      "%" +
                    "</span>" +
                  "</div>" +
                "</div>" +
              "</div>" +
            "</div>"
          ); 

          // $("#debuffs").append("ciao");
        }
        
      }

      function updateCrit() {
        var crit = 0;

        if (!Number.isNaN(parseInt($("#critInput").val()))) {
          crit += parseInt($("#critInput").val());
        }
        
        if (totalCrit == true) {
          if (crit < classes[currentClass].baseCrit) {
            crit = classes[currentClass].baseCrit;
          }
        }

        if (totalCrit == false) {
          crit += classes[currentClass].baseCrit;
        }

        if (priest == true) {
          crit += classes[currentClass].baseCrit * 0.36;
        }

        if (mystic == true) {
          crit += classes[currentClass].baseCrit * 1.2;
        }

        $('#buffedCrit').text(Math.trunc(crit));
      }

      function updateBossStats() {
        $("#bossLevel").val(bosses[currentBoss].level);
        $("#critResist").val(bosses[currentBoss].critResist);
        $("#ampResist").val(bosses[currentBoss].ampResist);
      }

    </script>

    <script>
      var typingTimer;                //timer identifier
      var doneTypingInterval = 100;  //time in ms, 5 second for example
      var $input = $('#critInput');

      // on keyup, start the countdown
      $input.on('keyup', function () {
        clearTimeout(typingTimer);
        typingTimer = setTimeout(doneTyping, doneTypingInterval);
      });

      // on keydown, clear the countdown 
      $input.on('keydown', function () {
        clearTimeout(typingTimer);
      });

      //user is "finished typing," do something
      function doneTyping () {
        updateCrit();
      }
    </script>

  </body>
</html>

